# 夏季赛生成功能 - 快速开始指南

## 🚀 功能说明

MSI结束后，一键生成4个赛区（LPL、LCK、LEC、LCS）的夏季赛常规赛，包括：
- ✅ 自动创建夏季赛赛事
- ✅ 自动添加各赛区队伍
- ✅ 自动生成18轮BO3赛程
- ✅ 自动配置BO3积分规则

## 📦 前置条件

### 必须完成
1. ✅ 春季赛常规赛已完成
2. ✅ 春季赛季后赛已完成（4个赛区）
3. ✅ MSI已完成

### 数据准备
- 每个赛区有10支队伍
- 所有赛区数据正常

## 🎮 使用方法

### 方式1：前端操作（推荐）

1. 打开浏览器访问前端页面
2. 进入 **MSI管理** 页面
3. 确认MSI状态为"已完成"
4. 点击 **"生成夏季赛常规赛"** 按钮
5. 在确认对话框中点击 **"生成"**
6. 等待生成完成（约10-30秒）
7. 查看成功提示消息

**预期结果**：
```
✅ 所有赛区夏季赛生成完成！共生成 720 场比赛。可以前往赛程管理页面查看
```

### 方式2：API调用

```bash
# 获取当前赛季ID
SEASON_ID=$(curl -s http://localhost:3000/api/seasons/current | jq -r '.data.id')

# 生成夏季赛
curl -X POST http://localhost:3000/api/seasons/$SEASON_ID/proceed-to-summer \
  -H "Content-Type: application/json" | jq
```

### 方式3：使用测试脚本

```bash
# 在后端项目根目录执行
./test-summer-generation.sh
```

## 📊 验证结果

### 1. 前端验证
- 进入 **赛程管理** 页面
- 选择 **夏季赛**
- 选择任意赛区
- 查看是否有18轮赛程

### 2. 数据库验证

```sql
-- 查看生成的夏季赛
SELECT id, name, region_id, status 
FROM competitions 
WHERE type = 'summer' AND season_id = '1';

-- 查看每个赛区的比赛数
SELECT c.name, COUNT(m.id) as match_count
FROM competitions c
LEFT JOIN matches m ON c.id = m.competition_id
WHERE c.type = 'summer'
GROUP BY c.id, c.name;
```

**预期结果**：
- 4个夏季赛赛事（每个赛区1个）
- 每个赛区180场比赛
- 总共720场比赛

## ⚠️ 常见问题

### 问题1：提示"MSI尚未完成"

**原因**：MSI状态不是 completed

**解决**：
```sql
-- 检查MSI状态
SELECT status FROM msi_brackets WHERE season_id = '1';

-- 如果需要，手动更新MSI状态
UPDATE msi_brackets SET status = 'completed' WHERE season_id = '1';
```

### 问题2：某个赛区生成失败

**可能原因**：
- 该赛区缺少队伍
- 该赛区队伍数量不足10支

**解决**：
```sql
-- 检查各赛区队伍数量
SELECT region_id, COUNT(*) as team_count 
FROM teams 
GROUP BY region_id;

-- 如果某个赛区缺少队伍，需要先添加队伍
```

### 问题3：重复点击按钮

**现象**：提示"夏季赛已存在"

**说明**：这是正常的，系统会自动跳过已存在的夏季赛

**处理**：
- 如果需要重新生成，先删除已存在的夏季赛
- 或者直接使用已存在的夏季赛

## 🎯 下一步操作

夏季赛生成完成后：

1. **开始模拟夏季赛**
   - 进入赛程管理页面
   - 选择夏季赛和赛区
   - 点击"模拟本轮"进行比赛

2. **查看积分榜**
   - 每轮结束后自动更新
   - 支持查看各赛区排名

3. **完成夏季赛后**
   - 生成夏季赛季后赛
   - 最终完成世界赛

## 📝 技术细节

### BO3积分规则

根据策划案定义：
- **2:0 胜** → 3分（横扫对手）
- **2:1 胜** → 2分（艰难获胜）
- **2:1 负** → 1分（虽败犹荣）
- **2:0 负** → 0分（完败）

### 赛程设置

- **赛制**：BO3双循环
- **轮次**：18轮
- **比赛数**：每赛区180场
- **队伍数**：每赛区10支

### API端点

- **生成夏季赛**：`POST /api/seasons/:seasonId/proceed-to-summer`
- **查询进度**：`GET /api/seasons/:seasonId/progress`
- **查看赛事**：`GET /api/competitions?seasonId=:id&type=summer`

## 📚 相关文档

- [夏季赛生成功能完善报告](backend/夏季赛生成功能完善报告.md)
- [前后端联调实施报告](backend/夏季赛生成功能-前后端联调实施报告.md)
- [策划案](策划案.md)

---

**更新日期**: 2025-10-12  
**版本**: 1.0.0
