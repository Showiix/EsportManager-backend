# 电子竞技赛事管理系统 - 后端接口文档

## 文档说明

本文档描述了电子竞技赛事管理系统前端所需的全部后端API接口。后端开发人员应按照此文档实现相应的接口。

**版本**: v1.0
**文档更新日期**: 2025-10-11
**基础URL**: `http://your-api-domain.com` (待后端提供)

---

## 目录

1. [通用说明](#通用说明)
2. [战队管理 API](#战队管理-api)
3. [赛区管理 API](#赛区管理-api)
4. [赛季管理 API](#赛季管理-api)
5. [赛事管理 API](#赛事管理-api)
6. [比赛管理 API](#比赛管理-api)
7. [排名管理 API](#排名管理-api)
8. [统计数据 API](#统计数据-api)
9. [数据类型定义](#数据类型定义)

---

## 通用说明

### 1. 请求格式

所有API请求应遵循RESTful规范：

- **Content-Type**: `application/json`
- **字符编码**: `UTF-8`
- **日期格式**: ISO 8601 格式 (`YYYY-MM-DDTHH:mm:ss.sssZ`)

### 2. 统一响应格式

#### 成功响应

```json
{
  "success": true,
  "data": { ... },
  "message": "操作成功"
}
```

#### 错误响应

```json
{
  "success": false,
  "data": null,
  "message": "错误描述",
  "errors": ["详细错误信息1", "详细错误信息2"]
}
```

#### 分页响应

```json
{
  "data": [ ... ],
  "total": 100,
  "page": 1,
  "limit": 20,
  "totalPages": 5
}
```

### 3. HTTP状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 成功 |
| 201 | 创建成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

### 4. 查询参数（通用）

支持以下通用查询参数：

| 参数 | 类型 | 说明 | 示例 |
|------|------|------|------|
| page | number | 页码（从1开始） | `?page=1` |
| limit | number | 每页数量 | `?limit=20` |
| search | string | 搜索关键词 | `?search=FPX` |
| sortBy | string | 排序字段 | `?sortBy=name` |
| sortOrder | string | 排序方向 (asc/desc) | `?sortOrder=desc` |

---

## 战队管理 API

### 1. 获取战队列表

**接口**: `GET /api/teams`

**描述**: 获取战队列表，支持分页、搜索、筛选和排序

**请求参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| page | number | 否 | 页码，默认1 |
| limit | number | 否 | 每页数量，默认20 |
| search | string | 否 | 搜索战队名称 |
| regionId | string | 否 | 按赛区筛选 |
| minStrength | number | 否 | 最小战力值 (0-100) |
| maxStrength | number | 否 | 最大战力值 (0-100) |
| minWinRate | number | 否 | 最小胜率 (0-1) |
| sortBy | string | 否 | 排序字段: name, strength, winRate, totalPoints |
| sortOrder | string | 否 | asc 或 desc |

**响应示例**:

```json
{
  "data": [
    {
      "id": "1",
      "name": "FunPlus Phoenix",
      "regionId": "1",
      "strength": 85,
      "createdAt": "2024-01-01T00:00:00.000Z",
      "statistics": {
        "totalMatches": 24,
        "wins": 18,
        "losses": 6,
        "winRate": 0.75,
        "totalPoints": 45,
        "seasonPoints": 45,
        "intercontinentalPoints": 0
      }
    }
  ],
  "total": 40,
  "page": 1,
  "limit": 20,
  "totalPages": 2
}
```

---

### 2. 获取战队详情

**接口**: `GET /api/teams/:id`

**描述**: 获取单个战队的详细信息

**路径参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 战队ID |

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "FunPlus Phoenix",
    "regionId": "1",
    "strength": 85,
    "createdAt": "2024-01-01T00:00:00.000Z",
    "statistics": {
      "totalMatches": 24,
      "wins": 18,
      "losses": 6,
      "winRate": 0.75,
      "totalPoints": 45,
      "seasonPoints": 45,
      "intercontinentalPoints": 0
    }
  }
}
```

---

### 3. 创建战队

**接口**: `POST /api/teams`

**描述**: 创建新战队

**请求体**:

```json
{
  "name": "New Team",
  "regionId": "1",
  "strength": 75
}
```

**请求参数说明**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | 是 | 战队名称 |
| regionId | string | 是 | 所属赛区ID |
| strength | number | 是 | 战力值 (0-100) |

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "41",
    "name": "New Team",
    "regionId": "1",
    "strength": 75,
    "createdAt": "2025-10-11T10:00:00.000Z",
    "statistics": {
      "totalMatches": 0,
      "wins": 0,
      "losses": 0,
      "winRate": 0,
      "totalPoints": 0,
      "seasonPoints": 0,
      "intercontinentalPoints": 0
    }
  },
  "message": "战队创建成功"
}
```

---

### 4. 更新战队

**接口**: `PUT /api/teams/:id`

**描述**: 更新战队信息

**路径参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 战队ID |

**请求体**:

```json
{
  "name": "Updated Team Name",
  "strength": 80
}
```

**注意**: 所有字段都是可选的，只更新提供的字段

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "Updated Team Name",
    "regionId": "1",
    "strength": 80,
    "createdAt": "2024-01-01T00:00:00.000Z",
    "statistics": { ... }
  },
  "message": "战队更新成功"
}
```

---

### 5. 删除战队

**接口**: `DELETE /api/teams/:id`

**描述**: 删除战队

**路径参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 战队ID |

**响应示例**:

```json
{
  "success": true,
  "data": null,
  "message": "战队删除成功"
}
```

---

### 6. 获取战队统计数据

**接口**: `GET /api/teams/:id/statistics`

**描述**: 获取战队的统计数据

**响应示例**:

```json
{
  "success": true,
  "data": {
    "totalMatches": 24,
    "wins": 18,
    "losses": 6,
    "winRate": 0.75,
    "totalPoints": 45,
    "seasonPoints": 45,
    "intercontinentalPoints": 0
  }
}
```

---

### 7. 获取战队比赛历史

**接口**: `GET /api/teams/:id/matches`

**描述**: 获取战队的比赛历史

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| page | number | 否 | 页码 |
| limit | number | 否 | 每页数量 |
| seasonId | string | 否 | 筛选特定赛季 |
| status | string | 否 | 比赛状态筛选 |

**响应示例**:

```json
{
  "data": [
    {
      "id": "match-1",
      "competitionId": "comp-1",
      "homeTeamId": "1",
      "awayTeamId": "2",
      "round": 1,
      "stage": "regular_season",
      "status": "completed",
      "regionId": "1",
      "result": {
        "homeScore": 2,
        "awayScore": 1,
        "homePoints": 2,
        "awayPoints": 1,
        "winner": "1"
      },
      "scheduledAt": "2024-03-15T10:00:00.000Z",
      "playedAt": "2024-03-15T10:30:00.000Z"
    }
  ],
  "total": 24,
  "page": 1,
  "limit": 10,
  "totalPages": 3
}
```

---

## 赛区管理 API

### 1. 获取赛区列表

**接口**: `GET /api/regions`

**描述**: 获取所有赛区列表

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "id": "1",
      "name": "LPL",
      "teams": []
    },
    {
      "id": "2",
      "name": "LCK",
      "teams": []
    },
    {
      "id": "3",
      "name": "LEC",
      "teams": []
    },
    {
      "id": "4",
      "name": "LCS",
      "teams": []
    }
  ]
}
```

---

### 2. 获取赛区详情

**接口**: `GET /api/regions/:id`

**描述**: 获取单个赛区详情，包含该赛区的所有战队

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "LPL",
    "teams": [
      {
        "id": "1",
        "name": "FunPlus Phoenix",
        "regionId": "1",
        "strength": 85,
        "statistics": { ... }
      }
    ]
  }
}
```

---

### 3. 更新赛区信息

**接口**: `PUT /api/regions/:id`

**描述**: 更新赛区信息（通常只更新名称）

**请求体**:

```json
{
  "name": "LPL Pro League"
}
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "LPL Pro League",
    "teams": []
  },
  "message": "赛区更新成功"
}
```

---

### 4. 获取赛区下的战队

**接口**: `GET /api/regions/:id/teams`

**描述**: 获取指定赛区的所有战队

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "id": "1",
      "name": "FunPlus Phoenix",
      "regionId": "1",
      "strength": 85,
      "statistics": { ... }
    }
  ]
}
```

---

## 赛季管理 API

### 1. 获取赛季列表

**接口**: `GET /api/seasons`

**描述**: 获取所有赛季列表

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "id": "1",
      "name": "2024 赛季",
      "year": 2024,
      "status": "active",
      "currentStage": "summer",
      "competitions": []
    },
    {
      "id": "2",
      "name": "2025 赛季",
      "year": 2025,
      "status": "planned",
      "currentStage": "planned",
      "competitions": []
    }
  ]
}
```

---

### 2. 获取赛季详情

**接口**: `GET /api/seasons/:id`

**描述**: 获取单个赛季详情

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "1",
    "name": "2024 赛季",
    "year": 2024,
    "status": "active",
    "currentStage": "summer",
    "competitions": [
      {
        "id": "spring-2024",
        "name": "2024 春季赛",
        "type": "spring",
        "status": "completed"
      }
    ]
  }
}
```

---

### 3. 创建赛季

**接口**: `POST /api/seasons`

**描述**: 创建新赛季

**请求体**:

```json
{
  "name": "2025 赛季",
  "year": 2025,
  "status": "planned"
}
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "3",
    "name": "2025 赛季",
    "year": 2025,
    "status": "planned",
    "currentStage": "planned",
    "competitions": []
  },
  "message": "赛季创建成功"
}
```

---

### 4. 更新赛季

**接口**: `PUT /api/seasons/:id`

**描述**: 更新赛季信息

**请求体**:

```json
{
  "status": "active",
  "currentStage": "spring"
}
```

---

### 5. 获取赛季下的赛事

**接口**: `GET /api/seasons/:id/competitions`

**描述**: 获取指定赛季的所有赛事

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "id": "spring-2024",
      "name": "2024 春季赛",
      "type": "spring",
      "format": "regular_season",
      "seasonId": "1",
      "status": "completed",
      "teams": [],
      "matches": []
    }
  ]
}
```

---

## 赛事管理 API

### 1. 获取赛事列表

**接口**: `GET /api/competitions`

**描述**: 获取赛事列表

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| seasonId | string | 否 | 筛选特定赛季 |
| type | string | 否 | 赛事类型: spring, summer, msi, worlds, intercontinental |
| status | string | 否 | 赛事状态: planned, ongoing, completed |
| page | number | 否 | 页码 |
| limit | number | 否 | 每页数量 |

**响应示例**:

```json
{
  "data": [
    {
      "id": "spring-2024",
      "name": "2024 春季赛",
      "type": "spring",
      "format": "regular_season",
      "seasonId": "1",
      "status": "completed",
      "teams": [],
      "matches": [],
      "stages": []
    }
  ],
  "total": 5,
  "page": 1,
  "limit": 20,
  "totalPages": 1
}
```

---

### 2. 获取赛事详情

**接口**: `GET /api/competitions/:id`

**描述**: 获取单个赛事详情

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "spring-2024",
    "name": "2024 春季赛",
    "type": "spring",
    "format": "regular_season",
    "seasonId": "1",
    "status": "completed",
    "teams": [
      { "id": "1", "name": "FPX", ... }
    ],
    "matches": [
      { "id": "match-1", ... }
    ],
    "stages": [
      {
        "name": "常规赛",
        "format": "round_robin",
        "teams": []
      }
    ]
  }
}
```

---

### 3. 创建赛事

**接口**: `POST /api/competitions`

**描述**: 创建新赛事

**请求体**:

```json
{
  "name": "2025 春季赛",
  "type": "spring",
  "format": "regular_season",
  "seasonId": "2",
  "teamIds": ["1", "2", "3", "4", "5"]
}
```

**参数说明**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | 是 | 赛事名称 |
| type | string | 是 | spring/summer/msi/worlds/intercontinental |
| format | string | 是 | regular_season/playoffs/double_elimination/swiss/single_elimination |
| seasonId | string | 是 | 所属赛季ID |
| teamIds | string[] | 是 | 参赛战队ID列表 |

---

### 4. 更新赛事

**接口**: `PUT /api/competitions/:id`

**描述**: 更新赛事信息

**请求体**:

```json
{
  "status": "ongoing"
}
```

---

### 5. 删除赛事

**接口**: `DELETE /api/competitions/:id`

**描述**: 删除赛事

---

### 6. 开始赛事

**接口**: `POST /api/competitions/:id/start`

**描述**: 将赛事状态设置为进行中

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "spring-2025",
    "status": "ongoing",
    ...
  },
  "message": "赛事已开始"
}
```

---

### 7. 结束赛事

**接口**: `POST /api/competitions/:id/finish`

**描述**: 将赛事状态设置为已完成

---

### 8. 获取赛事比赛列表

**接口**: `GET /api/competitions/:id/matches`

**描述**: 获取赛事的所有比赛

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| round | number | 否 | 筛选特定轮次 |
| status | string | 否 | 筛选比赛状态 |

---

### 9. 生成赛事对阵

**接口**: `POST /api/competitions/:id/generate-matches`

**描述**: 根据赛事格式自动生成对阵表

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "id": "match-1",
      "competitionId": "spring-2025",
      "homeTeamId": "1",
      "awayTeamId": "2",
      "round": 1,
      "stage": "regular_season",
      "status": "scheduled",
      "regionId": "1"
    }
  ],
  "message": "对阵生成成功"
}
```

---

### 10. 获取赛事积分榜

**接口**: `GET /api/competitions/:id/standings`

**描述**: 获取赛事的积分榜

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "teamId": "1",
      "teamName": "FPX",
      "regionId": "1",
      "points": 45,
      "matches": 18,
      "wins": 15,
      "losses": 3,
      "winRate": 0.833,
      "position": 1
    }
  ]
}
```

---

## 比赛管理 API

### 1. 获取比赛列表

**接口**: `GET /api/matches`

**描述**: 获取比赛列表

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| competitionId | string | 否 | 筛选特定赛事 |
| round | number | 否 | 筛选特定轮次 |
| status | string | 否 | scheduled/ongoing/completed |
| page | number | 否 | 页码 |
| limit | number | 否 | 每页数量 |

---

### 2. 获取比赛详情

**接口**: `GET /api/matches/:id`

**描述**: 获取单场比赛详情

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "match-1",
    "competitionId": "spring-2024",
    "homeTeamId": "1",
    "awayTeamId": "2",
    "round": 1,
    "stage": "regular_season",
    "status": "completed",
    "regionId": "1",
    "result": {
      "homeScore": 2,
      "awayScore": 1,
      "homePoints": 2,
      "awayPoints": 1,
      "winner": "1"
    },
    "scheduledAt": "2024-03-15T10:00:00.000Z",
    "playedAt": "2024-03-15T10:30:00.000Z"
  }
}
```

---

### 3. 更新比赛

**接口**: `PUT /api/matches/:id`

**描述**: 更新比赛信息

**请求体**:

```json
{
  "status": "completed",
  "result": {
    "homeScore": 2,
    "awayScore": 1,
    "homePoints": 2,
    "awayPoints": 1,
    "winner": "1"
  }
}
```

---

### 4. 开始比赛

**接口**: `POST /api/matches/:id/start`

**描述**: 将比赛状态设置为进行中

---

### 5. 结束比赛

**接口**: `POST /api/matches/:id/finish`

**描述**: 结束比赛并记录结果

**请求体**:

```json
{
  "homeScore": 2,
  "awayScore": 1
}
```

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "match-1",
    "status": "completed",
    "result": {
      "homeScore": 2,
      "awayScore": 1,
      "homePoints": 2,
      "awayPoints": 1,
      "winner": "1"
    },
    "playedAt": "2024-03-15T10:30:00.000Z"
  },
  "message": "比赛结束"
}
```

---

### 6. 模拟比赛

**接口**: `POST /api/matches/:id/simulate`

**描述**: 根据战队实力自动模拟比赛结果

**响应示例**:

```json
{
  "success": true,
  "data": {
    "id": "match-1",
    "status": "completed",
    "result": {
      "homeScore": 2,
      "awayScore": 0,
      "homePoints": 3,
      "awayPoints": 0,
      "winner": "1"
    }
  },
  "message": "比赛模拟完成"
}
```

**模拟算法建议**:
- 根据两队战力值计算胜率
- 战力差距越大，强队获胜概率越高
- 2:0 获胜得3分，2:1 获胜得2分，1:2 失败得1分，0:2 失败得0分
- 参考前端的模拟引擎实现

---

## 排名管理 API

### 1. 获取赛区常规赛积分榜

**接口**: `GET /api/rankings/regional`

**描述**: 获取指定赛区、赛季、赛事类型的常规赛积分榜

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| regionId | string | 是 | 赛区ID |
| seasonId | string | 是 | 赛季ID |
| type | string | 是 | spring 或 summer |

**响应示例**:

```json
{
  "success": true,
  "data": {
    "regionId": "1",
    "regionName": "LPL",
    "seasonId": "1",
    "competitionType": "spring",
    "standings": [
      {
        "teamId": "1",
        "teamName": "FPX",
        "regionId": "1",
        "regionName": "LPL",
        "matchesPlayed": 18,
        "wins": 15,
        "losses": 3,
        "winRate": 83.33,
        "regularSeasonPoints": 45,
        "roundDifferential": 15,
        "position": 1,
        "lastUpdated": "2024-03-20T10:00:00.000Z"
      }
    ],
    "lastUpdated": "2024-03-20T10:00:00.000Z"
  }
}
```

---

### 2. 获取年度积分排名

**接口**: `GET /api/rankings/annual`

**描述**: 获取指定赛季的全球年度积分排名

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| seasonId | string | 是 | 赛季ID |

**响应示例**:

```json
{
  "success": true,
  "data": {
    "seasonId": "1",
    "seasonYear": 2024,
    "annualRankings": [
      {
        "teamId": "1",
        "teamName": "T1",
        "regionId": "2",
        "regionName": "LCK",
        "totalPoints": 350,
        "springPoints": 54,
        "summerPoints": 60,
        "playoffPoints": 50,
        "msiPoints": 100,
        "worldsPoints": 86,
        "intercontinentalPoints": 0,
        "achievements": [
          "2024 春季赛冠军",
          "MSI冠军",
          "世界亚军"
        ],
        "position": 1,
        "seasonId": "1"
      }
    ],
    "regionalStandings": {
      "spring": [
        {
          "regionId": "1",
          "regionName": "LPL",
          "standings": [ ... ]
        }
      ],
      "summer": [
        {
          "regionId": "1",
          "regionName": "LPL",
          "standings": [ ... ]
        }
      ]
    },
    "lastUpdated": "2024-11-20T10:00:00.000Z"
  }
}
```

---

### 3. 更新赛区常规赛积分榜

**接口**: `POST /api/rankings/regional/update`

**描述**: 在比赛结束后更新赛区常规赛积分榜

**请求体**:

```json
{
  "regionId": "1",
  "seasonId": "1",
  "competitionType": "spring"
}
```

---

### 4. 更新年度积分排名

**接口**: `POST /api/rankings/annual/update`

**描述**: 在重要赛事（季后赛、MSI、世界赛）结束后更新年度积分排名

**请求体**:

```json
{
  "seasonId": "1"
}
```

---

### 5. 批量刷新所有排名

**接口**: `POST /api/rankings/refresh`

**描述**: 刷新指定赛季的所有排名数据（赛区常规赛 + 年度积分）

**请求体**:

```json
{
  "seasonId": "1"
}
```

---

## 统计数据 API

### 1. 获取全局统计

**接口**: `GET /api/statistics/global`

**描述**: 获取全局统计数据

**响应示例**:

```json
{
  "success": true,
  "data": {
    "totalTeams": 40,
    "totalMatches": 500,
    "completedMatches": 450,
    "ongoingCompetitions": 2,
    "totalSeasons": 2,
    "averageTeamStrength": 72.5
  }
}
```

---

### 2. 获取赛区统计

**接口**: `GET /api/statistics/regions`

**描述**: 获取所有赛区的统计数据

**响应示例**:

```json
{
  "success": true,
  "data": [
    {
      "regionId": "1",
      "regionName": "LPL",
      "totalTeams": 10,
      "averageStrength": 73.5,
      "averageWinRate": 0.5,
      "totalMatches": 180,
      "totalPoints": 270
    }
  ]
}
```

---

### 3. 获取战队对比数据

**接口**: `GET /api/statistics/compare`

**描述**: 对比多个战队的数据

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| teamIds | string | 是 | 战队ID列表，逗号分隔 |

**示例**: `/api/statistics/compare?teamIds=1,2,3`

**响应示例**:

```json
{
  "success": true,
  "data": {
    "teams": [
      {
        "id": "1",
        "name": "FPX",
        "strength": 85,
        "totalMatches": 24,
        "wins": 18,
        "winRate": 0.75
      }
    ],
    "comparisonMetrics": {
      "strengthComparison": [85, 82, 80],
      "winRateComparison": [0.75, 0.71, 0.67],
      "pointsComparison": [45, 42, 39]
    }
  }
}
```

---

## 数据类型定义

### Team（战队）

```typescript
interface Team {
  id: string
  name: string
  regionId: string
  strength: number // 0-100
  createdAt?: string
  statistics?: TeamStatistics
}
```

### TeamStatistics（战队统计）

```typescript
interface TeamStatistics {
  totalMatches: number
  wins: number
  losses: number
  winRate: number // 0-1
  totalPoints: number
  seasonPoints: number
  intercontinentalPoints: number
}
```

### Region（赛区）

```typescript
interface Region {
  id: string
  name: string
  teams?: Team[]
}
```

### Season（赛季）

```typescript
interface Season {
  id: string
  name: string
  year: number
  status: 'planned' | 'active' | 'completed'
  currentStage: string
  competitions?: Competition[]
}
```

### Competition（赛事）

```typescript
interface Competition {
  id: string
  name: string
  type: 'spring' | 'msi' | 'summer' | 'worlds' | 'intercontinental'
  format: 'regular_season' | 'playoffs' | 'double_elimination' | 'swiss' | 'single_elimination'
  seasonId: string
  status: 'planned' | 'ongoing' | 'completed'
  teams: Team[]
  matches?: Match[]
  stages?: CompetitionStage[]
}
```

### Match（比赛）

```typescript
interface Match {
  id: string
  competitionId: string
  homeTeamId: string
  awayTeamId: string
  round: number
  stage: string
  status: 'scheduled' | 'ongoing' | 'completed'
  regionId: string
  result?: MatchResult
  scheduledAt?: string
  playedAt?: string
}
```

### MatchResult（比赛结果）

```typescript
interface MatchResult {
  homeScore: number // 0-2
  awayScore: number // 0-2
  homePoints: number // 0-3 (积分)
  awayPoints: number // 0-3 (积分)
  winner?: string // 获胜战队ID
}
```

**积分规则**:
- 2:0 获胜 → 获胜方3分，失败方0分
- 2:1 获胜 → 获胜方2分，失败方1分

### CompetitionStage（赛事阶段）

```typescript
interface CompetitionStage {
  name: string
  format: string
  teams: Team[]
  brackets?: BracketNode[]
}
```

### RegularSeasonStanding（常规赛积分榜）

```typescript
interface RegularSeasonStanding {
  teamId: string
  teamName: string
  regionId: string
  regionName: string
  matchesPlayed: number
  wins: number
  losses: number
  winRate: number // 百分比，如 83.33
  regularSeasonPoints: number
  roundDifferential: number // 小场分差
  lastUpdated: string
  position: number // 排名
}
```

### AnnualTeamRanking（年度积分排名）

```typescript
interface AnnualTeamRanking {
  teamId: string
  teamName: string
  regionId: string
  regionName: string
  totalPoints: number // 总积分（不包含洲际赛）
  springPoints: number // 春季赛积分
  summerPoints: number // 夏季赛积分
  playoffPoints: number // 季后赛积分
  msiPoints: number // MSI积分
  worldsPoints: number // 世界赛积分
  intercontinentalPoints: number // 洲际赛积分（仅展示，不计入总分）
  achievements: string[] // 成就列表
  position: number // 全球排名
  seasonId: string
}
```

---

## 积分计算规则

### 1. 常规赛积分

| 结果 | 积分 |
|------|------|
| 2:0 获胜 | 3分 |
| 2:1 获胜 | 2分 |
| 1:2 失败 | 1分 |
| 0:2 失败 | 0分 |

### 2. 季后赛积分

| 名次 | 积分 |
|------|------|
| 冠军 | 50分 |
| 亚军 | 35分 |
| 半决赛（3-4名） | 25分 |
| 四分之一（5-8名） | 15分 |

### 3. MSI积分

| 名次 | 积分 |
|------|------|
| 冠军 | 100分 |
| 亚军 | 80分 |
| 半决赛 | 60分 |
| 小组赛 | 20分 |

### 4. 世界赛积分

| 名次 | 积分 |
|------|------|
| 冠军 | 150分 |
| 亚军 | 120分 |
| 半决赛 | 90分 |
| 四分之一 | 60分 |
| 小组赛 | 30分 |

### 5. 洲际赛积分

**重要**: 洲际赛积分**不计入年度总积分排名**，仅用于荣誉展示

| 名次 | 荣誉积分 |
|------|---------|
| 冠军 | 0分（荣誉展示）|
| 亚军 | 0分（荣誉展示）|

---

## CORS配置

后端需要配置CORS允许前端访问：

```javascript
// 示例配置
app.use(cors({
  origin: 'http://localhost:5173', // 开发环境
  credentials: true
}))
```

生产环境需要修改为实际的前端域名。

---

## 数据库设计建议

### 核心表

1. **teams** - 战队表
2. **regions** - 赛区表
3. **seasons** - 赛季表
4. **competitions** - 赛事表
5. **matches** - 比赛表
6. **team_statistics** - 战队统计表
7. **regional_standings** - 赛区积分榜表
8. **annual_rankings** - 年度积分排名表

### 关系

- Team N:1 Region
- Competition N:1 Season
- Match N:1 Competition
- Match N:1 Team (home)
- Match N:1 Team (away)

---

## 测试建议

### 1. 测试工具

推荐使用以下工具测试API：
- **Postman** - API测试工具
- **cURL** - 命令行测试
- **Thunder Client** (VS Code插件)

### 2. 测试数据

建议使用前端提供的mock数据作为测试数据：
- 4个赛区：LPL, LCK, LEC, LCS
- 每个赛区10支战队（共40支）
- 参考 `/src/api/index.ts` 中的 mockData

---

## 开发建议

### 1. 技术栈推荐

**Node.js 后端**:
- Express.js / Koa / NestJS
- TypeScript
- PostgreSQL / MySQL / MongoDB
- Prisma / TypeORM (ORM)

**Python 后端**:
- FastAPI / Django / Flask
- SQLAlchemy (ORM)
- PostgreSQL / MySQL

**Java 后端**:
- Spring Boot
- MyBatis / JPA
- PostgreSQL / MySQL

### 2. 项目结构建议

```
backend/
├── src/
│   ├── controllers/     # 控制器
│   ├── services/        # 业务逻辑
│   ├── models/          # 数据模型
│   ├── routes/          # 路由
│   ├── middlewares/     # 中间件
│   ├── utils/           # 工具函数
│   └── config/          # 配置文件
├── tests/               # 测试文件
└── package.json
```

### 3. 实现优先级

**第一阶段（核心功能）**:
1. 战队管理API
2. 赛区管理API
3. 赛季管理API

**第二阶段（赛事系统）**:
4. 赛事管理API
5. 比赛管理API
6. 比赛模拟功能

**第三阶段（排名系统）**:
7. 排名管理API
8. 统计数据API
9. 积分计算逻辑

---

## 注意事项

1. **数据一致性**: 确保比赛结果更新时同步更新战队统计和积分榜
2. **并发控制**: 比赛模拟时需要考虑并发问题
3. **性能优化**: 积分榜查询可以考虑缓存
4. **错误处理**: 统一的错误处理和错误码
5. **日志记录**: 记录关键操作日志
6. **数据校验**: 严格的输入数据校验

---

## 联系方式

如有疑问，请联系前端开发人员获取更多信息。

**文档版本**: v1.0
**最后更新**: 2025-10-11
